{
  "name": "purge_haplotigs_contigcov_and_purge",
  "title": "Purge Haplotigs contigcov then purge",
  "summary": "Pipeline to help with curating heterozygous diploid genome assemblies",
  "dxapi": "1.0.0",
  "version": "0.0.2",
  "inputSpec": [
    {   
      "name": "genome",
      "label": "Reference Genome",
      "class": "file",
      "optional": false,
      "patterns": [ "*.fa.gz", "*.fasta.gz" ],
      "help": "The reference genome for this species, may be primary contigs from FALCON-unzip" 
    },
    {
      "name": "alignment",
      "label": "Alignment",
      "class": "file",
      "optional": false,
      "patterns": [ "*.bam" ],
      "help": "The BAM file produced from aligning the raw sequencing data to the reference genome."  
    },
    {
      "name": "coverage_stats",
      "label": "Coverage Stats",
      "class": "string",
      "optional": true,
      "help": "The output prefix name for the coverage statistics file generated by purge_haplotigs contigcov."
    },
    {
      "name": "genome_coverage",
      "label": "Genome Coverage",
      "class": "file",
      "optional": false,
      "patterns": [
        "*.gencov"
      ],
      "help": "A file containing genome coverage information produced from purge_haplotigs readhist"
    },
    {
      "name": "low_cutoff",
      "label": "Low Cutoff",
      "class": "int",
      "optional": false,
      "help": "The low bound of read depth to choose as a cutoff from the PNG file produced from purge_haplotigs readhist."
    },
    {
      "name": "midpoint",
      "label": "Midpoint",
      "class": "int",
      "optional": false,
      "help": "The midpoint between the haploid and diploid peaks from the PNG file produced from purge_haplotigs readhist."
    },
    {
      "name": "high_cutoff",
      "label": "High Cutoff",
      "class": "int",
      "optional": false,
      "help": "The high bound of read depth to choose as a cutoff from the PNG file produced from purge_haplotigs readhist."
    },
    {
      "name": "dotplots",
      "label": "Dotplots",
      "class": "boolean",
      "optional": true,
      "default": true,
      "help": "Generate dotplots for the curated assemblies"
    },
    {
      "name": "aln_cov",
      "label": "Alignment Coverage",
      "class": "int",
      "optional": false,
      "default": 70,
      "help": "Percent cutoff for identifying a contig as a haplotig."
    },
    {
      "name": "junk_threshold",
      "label": "Junk Threshold",
      "class": "int",
      "optional": false,
      "default": 200,
      "help": "Assigns contig as junk if this percentage or greater of the contig is low/high coverage"
    },
    {
      "name": "suspect_threshold",
      "label": "Suspect Threshold",
      "class": "int",
      "optional": false,
      "default": 0,
      "help": "Assigns contig as suspected haplotig if this percentage or less of the contig is diploid level of coverage"
    }
  ],
  "outputSpec": [
    {
      "name": "cov_stats",
      "label": "Coverage Statistics",
      "class": "file",
      "patterns": [
        "*.csv.gz"
      ],
      "help": ""
    },
    {
      "name": "curated_assembly",
      "label": "Curated Assembly",
      "class": "file",
      "patterns": [
        "*.fa.gz", "*.fasta.gz"
      ],
      "help": ""
    },
    {   
      "name": "curated_haplotigs",
      "label": "Curated Haplotigs",
      "class": "file",
      "patterns": [
        "*.fa.gz", "*.fasta.gz"
      ],  
      "help": ""
    }, 
    {
      "name": "curated_artifacts",
      "label": "Curated Artifacts",
      "class": "file",
      "optional": true,
      "patterns": [
        "*.fa.gz", "*.fasta.gz"
      ],
      "help": "These are the contigs that were flagged as 'junk' based on the read-depth information."
    },
    {
      "name": "curated_reassignments",
      "label": "Curated Reassignments",
      "class": "file",
      "patterns": [
        "*.tsv"
      ],
      "help": "This file lists all the reassignments that were made as well as the two alignment scores used to determine the reassignments."
    },
    {
      "name": "curated_contig_associations",
      "label": "Curated Contig Associations",
      "class": "file",
      "patterns": [
        "*.log"
      ],
      "help": "This file shows the purging order for the contig reassignments."
    },
    {
      "name": "dotplots_reassigned_contigs",
      "label": "Dotplots Reassigned Contigs",
      "class": "file",
      "patterns": [
        "*.tar.gz"
      ],
      "help": "Dotplots for all of the reassigned contigs."
    },
    {
      "name": "dotplots_unassigned_contigs",
      "label": "Dotplots Unassigned Contigs",
      "class": "file",
      "patterns": [
        "*.tar.gz"
      ],
      "help": "Dotplots for all of the unassigned contigs."
    }
  ],
  "runSpec": {
    "timeoutPolicy": {
      "*": {
        "hours": 48
      }
    },
    "interpreter": "bash",
    "release": "14.04",
    "distribution": "Ubuntu",
    "file": "src/code.sh"
  },
  "regionalOptions": {
    "aws:us-east-1": {
      "systemRequirements": {
        "*": {
          "instanceType": "mem3_ssd1_x32"
        }
      },
      "assetDepends": [ {"id": "record-FPJfkZQ0j07v25JXGpGyfpy4", "name": "purge_haplotigs_ubuntu14.04"} ]	
    }
  },
  "details": {
    "whatsNew": "* 0.0.2 change default value for junk and suspect"
    } 
}
